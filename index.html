<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>列车受电弓检测与维护系统</title>
    <style>
        :root {
            --primary-color: #1a3a8f;
            --secondary-color: #2c5aa0;
            --danger-color: #e74c3c;
            --warning-color: #f39c12;
            --success-color: #27ae60;
            --info-color: #17a2b8;
            --light-color: #f8f9fa;
            --dark-color: #343a40;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Microsoft YaHei', Arial, sans-serif;
        }
        
        body {
            background-color: #f0f2f5;
            color: #333;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
            color: white;
            padding: 20px 0;
            border-radius: 10px;
            margin-bottom: 20px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        
        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 20px;
        }
        
        .logo {
            display: flex;
            align-items: center;
        }
        
        .logo h1 {
            font-size: 24px;
            margin-left: 10px;
        }
        
        .status-indicator {
            display: flex;
            align-items: center;
            background: rgba(255, 255, 255, 0.2);
            padding: 8px 15px;
            border-radius: 20px;
        }
        
        .status-dot {
            width: 12px;
            height: 12px;
            background-color: #4CAF50;
            border-radius: 50%;
            margin-right: 8px;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }
        
        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .panel {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .panel:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
        }
        
        .panel h2 {
            color: var(--primary-color);
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #f0f2f5;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .panel h2 .panel-actions {
            font-size: 14px;
            font-weight: normal;
        }
        
        .control-panel {
            grid-column: 1 / 3;
        }
        
        .function-buttons {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
        }
        
        .btn {
            background: var(--primary-color);
            color: white;
            border: none;
            padding: 15px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
        }
        
        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s;
        }
        
        .btn:hover::before {
            left: 100%;
        }
        
        .btn:hover {
            background: var(--secondary-color);
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        
        .btn:disabled {
            background: #cccccc;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .btn:disabled:hover::before {
            left: -100%;
        }
        
        .btn i {
            font-size: 24px;
            margin-bottom: 8px;
        }
        
        .btn-danger {
            background: var(--danger-color);
        }
        
        .btn-danger:hover {
            background: #c0392b;
        }
        
        .btn-warning {
            background: var(--warning-color);
        }
        
        .btn-warning:hover {
            background: #e67e22;
        }
        
        .btn-success {
            background: var(--success-color);
        }
        
        .btn-success:hover {
            background: #219955;
        }
        
        .btn-emergency {
            background: #d32f2f;
            animation: blink 1.5s infinite;
        }
        
        @keyframes blink {
            0%, 50% { background-color: #d32f2f; }
            51%, 100% { background-color: #f44336; }
        }
        
        .status-panel {
            display: flex;
            flex-direction: column;
        }
        
        .status-item {
            display: flex;
            justify-content: space-between;
            padding: 12px 0;
            border-bottom: 1px solid #f0f2f5;
        }
        
        .status-value {
            font-weight: bold;
        }
        
        .status-normal {
            color: var(--success-color);
        }
        
        .status-warning {
            color: var(--warning-color);
        }
        
        .status-danger {
            color: var(--danger-color);
        }
        
        .visualization {
            position: relative;
            height: 300px;
            background: linear-gradient(to bottom, #1a3a8f, #2c5aa0);
            border-radius: 8px;
            overflow: hidden;
        }
        
        .pantograph {
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 300px;
            height: 200px;
        }
        
        .base {
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 120px;
            height: 20px;
            background: #555;
            border-radius: 5px 5px 0 0;
        }
        
        .arm {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            width: 10px;
            height: 150px;
            background: #777;
        }
        
        .contact-strip {
            position: absolute;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 200px;
            height: 15px;
            background: #ddd;
            border-radius: 10px;
        }
        
        .detection-point {
            position: absolute;
            width: 8px;
            height: 8px;
            background: #ffeb3b;
            border-radius: 50%;
            transform: translate(-50%, -50%);
            box-shadow: 0 0 10px #ffeb3b;
            transition: all 0.5s ease;
        }
        
        .detection-point.active {
            background: #ff5722;
            box-shadow: 0 0 15px #ff5722;
            animation: pulse 1s infinite;
        }
        
        .detection-point.detected {
            background: #4CAF50;
            box-shadow: 0 0 15px #4CAF50;
        }
        
        .detection-point.issue {
            background: #f44336;
            box-shadow: 0 0 15px #f44336;
            animation: shake 0.5s ease-in-out infinite;
        }
        
        @keyframes shake {
            0%, 100% { transform: translate(-50%, -50%); }
            25% { transform: translate(-52%, -50%); }
            75% { transform: translate(-48%, -50%); }
        }
        
        .data-panel {
            grid-column: 1 / 3;
        }
        
        .chart-container {
            height: 200px;
            margin-top: 15px;
            position: relative;
        }
        
        .chart {
            width: 100%;
            height: 100%;
            background: #f8f9fa;
            border-radius: 5px;
            position: relative;
            overflow: hidden;
        }
        
        .chart-line {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 0;
            background: var(--primary-color);
            transition: height 1s ease;
        }
        
        .chart-labels {
            display: flex;
            justify-content: space-between;
            margin-top: 10px;
            font-size: 12px;
            color: #666;
        }
        
        .alert-panel {
            grid-column: 1 / 3;
        }
        
        .alert-list {
            max-height: 200px;
            overflow-y: auto;
        }
        
        .alert-item {
            padding: 12px 15px;
            margin-bottom: 10px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            animation: slideIn 0.3s ease;
        }
        
        @keyframes slideIn {
            from { opacity: 0; transform: translateX(-20px); }
            to { opacity: 1; transform: translateX(0); }
        }
        
        .alert-warning {
            background: #fff3cd;
            border-left: 4px solid var(--warning-color);
        }
        
        .alert-danger {
            background: #f8d7da;
            border-left: 4px solid var(--danger-color);
        }
        
        .alert-info {
            background: #d1ecf1;
            border-left: 4px solid var(--info-color);
        }
        
        .alert-success {
            background: #d4edda;
            border-left: 4px solid var(--success-color);
        }
        
        .alert-icon {
            margin-right: 10px;
            font-size: 20px;
        }
        
        .progress-container {
            margin-top: 15px;
        }
        
        .progress-bar {
            height: 10px;
            background: #e9ecef;
            border-radius: 5px;
            overflow: hidden;
            position: relative;
        }
        
        .progress {
            height: 100%;
            background: var(--primary-color);
            width: 0%;
            transition: width 0.5s ease;
        }
        
        .progress-text {
            text-align: center;
            margin-top: 5px;
            font-size: 14px;
            color: #666;
        }
        
        .task-queue {
            margin-top: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
        }
        
        .task-list {
            list-style-type: none;
        }
        
        .task-item {
            padding: 8px 0;
            border-bottom: 1px solid #e9ecef;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .task-item:last-child {
            border-bottom: none;
        }
        
        .task-status {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            margin-right: 10px;
        }
        
        .task-pending {
            background: var(--warning-color);
        }
        
        .task-running {
            background: var(--info-color);
            animation: pulse 1s infinite;
        }
        
        .task-completed {
            background: var(--success-color);
        }
        
        .sensor-data {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-top: 15px;
        }
        
        .sensor-item {
            background: #f8f9fa;
            padding: 10px;
            border-radius: 5px;
            text-align: center;
        }
        
        .sensor-value {
            font-size: 18px;
            font-weight: bold;
            margin-top: 5px;
        }
        
        .history-panel {
            grid-column: 1 / 3;
        }
        
        .history-list {
            max-height: 200px;
            overflow-y: auto;
        }
        
        .history-item {
            padding: 10px 15px;
            border-bottom: 1px solid #f0f2f5;
            display: flex;
            justify-content: space-between;
        }
        
        .history-item:last-child {
            border-bottom: none;
        }
        
        footer {
            text-align: center;
            padding: 20px;
            color: #666;
            font-size: 14px;
            border-top: 1px solid #e9ecef;
            margin-top: 20px;
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        
        .modal-content {
            background: white;
            padding: 20px;
            border-radius: 10px;
            width: 400px;
            max-width: 90%;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }
        
        .modal-buttons {
            display: flex;
            justify-content: flex-end;
            margin-top: 20px;
            gap: 10px;
        }
        
        .tab-container {
            margin-top: 15px;
        }
        
        .tabs {
            display: flex;
            border-bottom: 1px solid #e9ecef;
        }
        
        .tab {
            padding: 10px 15px;
            cursor: pointer;
            border-bottom: 2px solid transparent;
        }
        
        .tab.active {
            border-bottom: 2px solid var(--primary-color);
            color: var(--primary-color);
            font-weight: bold;
        }
        
        .tab-content {
            padding: 15px 0;
        }
        
        .tab-pane {
            display: none;
        }
        
        .tab-pane.active {
            display: block;
        }
        
        .settings-item {
            margin-bottom: 15px;
        }
        
        .settings-item label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        
        .settings-item input, .settings-item select {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        
        /* 新增样式 */
        .maintenance-schedule {
            margin-top: 15px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
        }
        
        .schedule-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid #e9ecef;
        }
        
        .schedule-item:last-child {
            border-bottom: none;
        }
        
        .report-panel {
            grid-column: 1 / 3;
        }
        
        .report-actions {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .report-content {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
            min-height: 150px;
            font-family: monospace;
            white-space: pre-wrap;
        }
        
        .performance-indicators {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin-top: 15px;
        }
        
        .indicator {
            background: #f8f9fa;
            padding: 10px;
            border-radius: 5px;
            text-align: center;
        }
        
        .indicator-value {
            font-size: 20px;
            font-weight: bold;
            margin-top: 5px;
        }
        
        .indicator-title {
            font-size: 12px;
            color: #666;
        }
        
        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            
            .control-panel, .alert-panel, .data-panel, .history-panel, .report-panel {
                grid-column: 1;
            }
            
            .function-buttons {
                grid-template-columns: 1fr 1fr;
            }
            
            .sensor-data, .performance-indicators {
                grid-template-columns: 1fr;
            }
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <div class="container">
        <header>
            <div class="header-content">
                <div class="logo">
                    <i class="fas fa-train fa-2x"></i>
                    <h1>列车受电弓检测与维护系统</h1>
                </div>
                <div class="status-indicator">
                    <div class="status-dot"></div>
                    <span>系统运行正常</span>
                </div>
            </div>
        </header>
        
        <div class="main-content">
            <div class="panel control-panel">
                <h2>控制面板</h2>
                <div class="function-buttons">
                    <button class="btn" id="startDetection">
                        <i class="fas fa-search"></i>
                        <span>开始检测</span>
                    </button>
                    <button class="btn btn-warning" id="startRepair" disabled>
                        <i class="fas fa-tools"></i>
                        <span>开始维修</span>
                    </button>
                    <button class="btn" id="startCleaning">
                        <i class="fas fa-spray-can"></i>
                        <span>开始清洗</span>
                    </button>
                    <button class="btn" id="startDrying">
                        <i class="fas fa-wind"></i>
                        <span>开始烘干</span>
                    </button>
                    <button class="btn btn-emergency" id="emergencyStop">
                        <i class="fas fa-exclamation-triangle"></i>
                        <span>紧急停止</span>
                    </button>
                </div>
                
                <div class="progress-container">
                    <div class="progress-bar">
                        <div class="progress" id="operationProgress"></div>
                    </div>
                    <div class="progress-text" id="progressText">准备就绪</div>
                </div>
                
                <div class="task-queue">
                    <h3>任务队列</h3>
                    <ul class="task-list" id="taskList">
                        <!-- 任务将通过JS动态添加 -->
                    </ul>
                </div>
                
                <div class="maintenance-schedule">
                    <h3>维护计划</h3>
                    <div class="schedule-item">
                        <span>日常检测</span>
                        <span>每天 08:00</span>
                    </div>
                    <div class="schedule-item">
                        <span>深度清洗</span>
                        <span>每周一 14:00</span>
                    </div>
                    <div class="schedule-item">
                        <span>全面检查</span>
                        <span>每月1号 09:00</span>
                    </div>
                </div>
            </div>
            
            <div class="panel status-panel">
                <h2>系统状态</h2>
                <div class="status-item">
                    <span>超声波检测状态:</span>
                    <span class="status-value status-normal" id="ultrasonicStatus">正常</span>
                </div>
                <div class="status-item">
                    <span>维修系统状态:</span>
                    <span class="status-value status-normal" id="repairStatus">待机</span>
                </div>
                <div class="status-item">
                    <span>清洗系统状态:</span>
                    <span class="status-value status-normal" id="cleaningStatus">待机</span>
                </div>
                <div class="status-item">
                    <span>烘干系统状态:</span>
                    <span class="status-value status-normal" id="dryingStatus">待机</span>
                </div>
                <div class="status-item">
                    <span>受电弓状态:</span>
                    <span class="status-value status-normal" id="pantographStatus">正常</span>
                </div>
                <div class="status-item">
                    <span>系统温度:</span>
                    <span class="status-value status-normal" id="systemTemp">42°C</span>
                </div>
                
                <div class="sensor-data">
                    <div class="sensor-item">
                        <div>压力传感器</div>
                        <div class="sensor-value" id="pressureSensor">3.2 MPa</div>
                    </div>
                    <div class="sensor-item">
                        <div>温度传感器</div>
                        <div class="sensor-value" id="temperatureSensor">65°C</div>
                    </div>
                    <div class="sensor-item">
                        <div>振动传感器</div>
                        <div class="sensor-value" id="vibrationSensor">0.12 g</div>
                    </div>
                    <div class="sensor-item">
                        <div>电流传感器</div>
                        <div class="sensor-value" id="currentSensor">125 A</div>
                    </div>
                </div>
                
                <div class="performance-indicators">
                    <div class="indicator">
                        <div class="indicator-title">系统可用性</div>
                        <div class="indicator-value status-normal">99.8%</div>
                    </div>
                    <div class="indicator">
                        <div class="indicator-title">检测准确率</div>
                        <div class="indicator-value status-normal">98.5%</div>
                    </div>
                    <div class="indicator">
                        <div class="indicator-title">平均响应时间</div>
                        <div class="indicator-value status-normal">2.3s</div>
                    </div>
                </div>
            </div>
            
            <div class="panel">
                <h2>受电弓可视化</h2>
                <div class="visualization">
                    <div class="pantograph">
                        <div class="base"></div>
                        <div class="arm"></div>
                        <div class="contact-strip"></div>
                        <div class="detection-point" style="top: 30%; left: 40%;" data-id="1"></div>
                        <div class="detection-point" style="top: 30%; left: 60%;" data-id="2"></div>
                        <div class="detection-point" style="top: 50%; left: 45%;" data-id="3"></div>
                        <div class="detection-point" style="top: 50%; left: 55%;" data-id="4"></div>
                    </div>
                </div>
            </div>
            
            <div class="panel data-panel">
                <h2>检测数据</h2>
                <div class="chart-container">
                    <div class="chart">
                        <div class="chart-line" id="dataChart"></div>
                    </div>
                    <div class="chart-labels">
                        <span>0%</span>
                        <span>25%</span>
                        <span>50%</span>
                        <span>75%</span>
                        <span>100%</span>
                    </div>
                </div>
            </div>
            
            <div class="panel history-panel">
                <h2>操作历史</h2>
                <div class="history-list" id="historyList">
                    <div class="history-item">
                        <div>系统启动</div>
                        <div>2023-11-15 08:30:25</div>
                    </div>
                </div>
            </div>
            
            <div class="panel report-panel">
                <h2>检测报告</h2>
                <div class="report-actions">
                    <button class="btn" id="generateReport">
                        <i class="fas fa-file-alt"></i>
                        <span>生成报告</span>
                    </button>
                    <button class="btn" id="exportReport">
                        <i class="fas fa-download"></i>
                        <span>导出报告</span>
                    </button>
                </div>
                <div class="report-content" id="reportContent">
                    <!-- 报告内容将通过JS动态生成 -->
                </div>
            </div>
            
            <div class="panel alert-panel">
                <h2>警报与提示</h2>
                <div class="alert-list" id="alertList">
                    <div class="alert-item alert-info">
                        <i class="fas fa-info-circle alert-icon"></i>
                        <div>
                            <strong>系统启动完成</strong>
                            <p>所有子系统已初始化，准备执行任务</p>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="panel">
                <h2>系统设置 <span class="panel-actions"><i class="fas fa-cog"></i></span></h2>
                <div class="tab-container">
                    <div class="tabs">
                        <div class="tab active" data-tab="general">常规设置</div>
                        <div class="tab" data-tab="detection">检测参数</div>
                        <div class="tab" data-tab="maintenance">维护参数</div>
                    </div>
                    <div class="tab-content">
                        <div class="tab-pane active" id="general-tab">
                            <div class="settings-item">
                                <label for="systemLanguage">系统语言</label>
                                <select id="systemLanguage">
                                    <option value="zh-CN">中文</option>
                                    <option value="en-US">English</option>
                                </select>
                            </div>
                            <div class="settings-item">
                                <label for="autoDetection">自动检测间隔(分钟)</label>
                                <input type="number" id="autoDetection" value="60" min="10" max="240">
                            </div>
                            <div class="settings-item">
                                <label for="dataRetention">数据保留天数</label>
                                <input type="number" id="dataRetention" value="30" min="7" max="365">
                            </div>
                        </div>
                        <div class="tab-pane" id="detection-tab">
                            <div class="settings-item">
                                <label for="ultrasonicSensitivity">超声波检测灵敏度</label>
                                <input type="range" id="ultrasonicSensitivity" min="1" max="10" value="7">
                            </div>
                            <div class="settings-item">
                                <label for="detectionThreshold">故障检测阈值</label>
                                <input type="range" id="detectionThreshold" min="1" max="10" value="5">
                            </div>
                        </div>
                        <div class="tab-pane" id="maintenance-tab">
                            <div class="settings-item">
                                <label for="cleaningDuration">清洗持续时间(秒)</label>
                                <input type="number" id="cleaningDuration" value="120" min="30" max="300">
                            </div>
                            <div class="settings-item">
                                <label for="dryingTemperature">烘干温度(°C)</label>
                                <input type="number" id="dryingTemperature" value="80" min="40" max="120">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <footer>
            <p>列车受电弓检测与维护系统 &copy; 2023 版权所有 | 版本 2.1.0</p>
        </footer>
    </div>

    <!-- 确认模态框 -->
    <div class="modal" id="confirmModal">
        <div class="modal-content">
            <h3 id="modalTitle">确认操作</h3>
            <p id="modalMessage">您确定要执行此操作吗？</p>
            <div class="modal-buttons">
                <button class="btn btn-danger" id="modalCancel">取消</button>
                <button class="btn btn-success" id="modalConfirm">确认</button>
            </div>
        </div>
    </div>

    <!-- 紧急停止模态框 -->
    <div class="modal" id="emergencyModal">
        <div class="modal-content">
            <h3>紧急停止</h3>
            <p>系统将立即停止所有操作，您确定要继续吗？</p>
            <div class="modal-buttons">
                <button class="btn" id="emergencyCancel">取消</button>
                <button class="btn btn-danger" id="emergencyConfirm">确认停止</button>
            </div>
        </div>
    </div>

    <script>
        // 系统状态
        const systemState = {
            isOperating: false,
            currentOperation: null,
            pantographHasIssue: false,
            taskQueue: [],
            operationHistory: [],
            reports: []
        };

        // 检测点状态
        const detectionPoints = [
            { id: 1, status: 'normal' },
            { id: 2, status: 'normal' },
            { id: 3, status: 'normal' },
            { id: 4, status: 'normal' }
        ];

        // DOM 元素
        const elements = {
            startDetection: document.getElementById('startDetection'),
            startRepair: document.getElementById('startRepair'),
            startCleaning: document.getElementById('startCleaning'),
            startDrying: document.getElementById('startDrying'),
            emergencyStop: document.getElementById('emergencyStop'),
            generateReport: document.getElementById('generateReport'),
            exportReport: document.getElementById('exportReport'),
            ultrasonicStatus: document.getElementById('ultrasonicStatus'),
            repairStatus: document.getElementById('repairStatus'),
            cleaningStatus: document.getElementById('cleaningStatus'),
            dryingStatus: document.getElementById('dryingStatus'),
            pantographStatus: document.getElementById('pantographStatus'),
            operationProgress: document.getElementById('operationProgress'),
            progressText: document.getElementById('progressText'),
            alertList: document.getElementById('alertList'),
            taskList: document.getElementById('taskList'),
            historyList: document.getElementById('historyList'),
            reportContent: document.getElementById('reportContent'),
            dataChart: document.getElementById('dataChart'),
            confirmModal: document.getElementById('confirmModal'),
            modalTitle: document.getElementById('modalTitle'),
            modalMessage: document.getElementById('modalMessage'),
            modalCancel: document.getElementById('modalCancel'),
            modalConfirm: document.getElementById('modalConfirm'),
            emergencyModal: document.getElementById('emergencyModal'),
            emergencyCancel: document.getElementById('emergencyCancel'),
            emergencyConfirm: document.getElementById('emergencyConfirm')
        };

        // 传感器数据
        const sensorData = {
            pressure: 3.2,
            temperature: 65,
            vibration: 0.12,
            current: 125
        };

        // 模拟操作进度
        function simulateProgress(operation, duration, callback) {
            if (systemState.isOperating) {
                addAlert('系统正在执行其他任务，请等待完成', 'warning');
                return;
            }
            
            systemState.isOperating = true;
            systemState.currentOperation = operation;
            
            // 添加到任务队列
            addTask(operation);
            
            // 记录操作历史
            addHistory(operation);
            
            const progressBar = elements.operationProgress;
            const progressText = elements.progressText;
            let width = 0;
            
            // 更新进度文本
            progressText.textContent = `${operation}中... 0%`;
            
            // 重置进度条
            progressBar.style.width = '0%';
            
            const interval = setInterval(() => {
                if (width >= 100) {
                    clearInterval(interval);
                    progressText.textContent = `${operation}完成`;
                    
                    // 添加完成提示
                    addAlert(`${operation}完成`, 'success');
                    
                    // 更新任务状态
                    updateTaskStatus(operation, 'completed');
                    
                    // 重置状态
                    setTimeout(() => {
                        progressText.textContent = '准备就绪';
                        systemState.isOperating = false;
                        systemState.currentOperation = null;
                        
                        // 执行回调函数
                        if (callback) callback();
                    }, 2000);
                } else {
                    width++;
                    progressBar.style.width = width + '%';
                    progressText.textContent = `${operation}中... ${width}%`;
                    
                    // 更新数据图表
                    updateDataChart(width);
                    
                    // 更新传感器数据
                    updateSensorData();
                }
            }, duration / 100);
        }
        
        // 添加警报
        function addAlert(message, type) {
            const alertList = elements.alertList;
            const alertTypes = {
                'warning': { class: 'alert-warning', icon: 'exclamation-triangle' },
                'danger': { class: 'alert-danger', icon: 'exclamation-circle' },
                'info': { class: 'alert-info', icon: 'info-circle' },
                'success': { class: 'alert-success', icon: 'check-circle' }
            };
            
            const alertType = alertTypes[type] || alertTypes['info'];
            
            const alertItem = document.createElement('div');
            alertItem.className = `alert-item ${alertType.class}`;
            alertItem.innerHTML = `
                <i class="fas fa-${alertType.icon} alert-icon"></i>
                <div>
                    <strong>${message}</strong>
                    <p>${new Date().toLocaleTimeString()}</p>
                </div>
            `;
            
            alertList.insertBefore(alertItem, alertList.firstChild);
            
            // 限制警报数量
            if (alertList.children.length > 5) {
                alertList.removeChild(alertList.lastChild);
            }
        }
        
        // 添加任务到队列
        function addTask(taskName) {
            const taskId = Date.now();
            systemState.taskQueue.push({
                id: taskId,
                name: taskName,
                status: 'running'
            });
            
            updateTaskList();
        }
        
        // 更新任务状态
        function updateTaskStatus(taskName, status) {
            const task = systemState.taskQueue.find(t => t.name === taskName && t.status === 'running');
            if (task) {
                task.status = status;
                updateTaskList();
            }
        }
        
        // 更新任务列表显示
        function updateTaskList() {
            const taskList = elements.taskList;
            taskList.innerHTML = '';
            
            systemState.taskQueue.forEach(task => {
                const taskItem = document.createElement('li');
                taskItem.className = 'task-item';
                
                let statusClass = '';
                let statusText = '';
                
                switch(task.status) {
                    case 'pending':
                        statusClass = 'task-pending';
                        statusText = '等待中';
                        break;
                    case 'running':
                        statusClass = 'task-running';
                        statusText = '执行中';
                        break;
                    case 'completed':
                        statusClass = 'task-completed';
                        statusText = '已完成';
                        break;
                }
                
                taskItem.innerHTML = `
                    <div>
                        <span class="task-status ${statusClass}"></span>
                        <span>${task.name}</span>
                    </div>
                    <span>${statusText}</span>
                `;
                
                taskList.appendChild(taskItem);
            });
        }
        
        // 添加操作历史
        function addHistory(operation) {
            const historyList = elements.historyList;
            const now = new Date();
            const timestamp = `${now.toLocaleDateString()} ${now.toLocaleTimeString()}`;
            
            const historyItem = document.createElement('div');
            historyItem.className = 'history-item';
            historyItem.innerHTML = `
                <div>${operation}</div>
                <div>${timestamp}</div>
            `;
            
            historyList.insertBefore(historyItem, historyList.firstChild);
            
            // 限制历史记录数量
            if (historyList.children.length > 10) {
                historyList.removeChild(historyList.lastChild);
            }
        }
        
        // 更新数据图表
        function updateDataChart(value) {
            elements.dataChart.style.height = `${value}%`;
        }
        
        // 更新传感器数据
        function updateSensorData() {
            // 模拟传感器数据变化
            sensorData.pressure = 3.2 + (Math.random() - 0.5) * 0.2;
            sensorData.temperature = 65 + (Math.random() - 0.5) * 5;
            sensorData.vibration = 0.12 + (Math.random() - 0.5) * 0.05;
            sensorData.current = 125 + (Math.random() - 0.5) * 10;
            
            document.getElementById('pressureSensor').textContent = `${sensorData.pressure.toFixed(1)} MPa`;
            document.getElementById('temperatureSensor').textContent = `${sensorData.temperature.toFixed(0)}°C`;
            document.getElementById('vibrationSensor').textContent = `${sensorData.vibration.toFixed(2)} g`;
            document.getElementById('currentSensor').textContent = `${sensorData.current.toFixed(0)} A`;
        }
        
        // 更新检测点状态
        function updateDetectionPoints() {
            detectionPoints.forEach(point => {
                const pointElement = document.querySelector(`.detection-point[data-id="${point.id}"]`);
                if (pointElement) {
                    pointElement.className = 'detection-point';
                    
                    if (point.status === 'active') {
                        pointElement.classList.add('active');
                    } else if (point.status === 'detected') {
                        pointElement.classList.add('detected');
                    } else if (point.status === 'issue') {
                        pointElement.classList.add('issue');
                    }
                }
            });
        }
        
        // 模拟超声波检测
        function simulateDetection() {
            const ultrasonicStatus = elements.ultrasonicStatus;
            const pantographStatus = elements.pantographStatus;
            
            // 更新状态
            ultrasonicStatus.textContent = '检测中';
            ultrasonicStatus.className = 'status-value status-warning';
            
            // 激活检测点
            detectionPoints.forEach(point => {
                point.status = 'active';
            });
            updateDetectionPoints();
            
            // 模拟检测过程
            simulateProgress('超声波检测', 5000, () => {
                // 模拟检测结果
                const issues = Math.random() > 0.7;
                
                if (issues) {
                    ultrasonicStatus.textContent = '发现异常';
                    ultrasonicStatus.className = 'status-value status-danger';
                    pantographStatus.textContent = '需要维修';
                    pantographStatus.className = 'status-value status-danger';
                    
                    // 随机设置一个有问题的检测点
                    const randomPoint = Math.floor(Math.random() * detectionPoints.length);
                    detectionPoints[randomPoint].status = 'issue';
                    
                    // 启用维修按钮
                    elements.startRepair.disabled = false;
                    
                    addAlert('超声波检测发现受电弓存在裂纹', 'danger');
                    systemState.pantographHasIssue = true;
                } else {
                    ultrasonicStatus.textContent = '正常';
                    ultrasonicStatus.className = 'status-value status-normal';
                    pantographStatus.textContent = '正常';
                    pantographStatus.className = 'status-value status-normal';
                    
                    // 设置检测点为正常状态
                    detectionPoints.forEach(point => {
                        point.status = 'detected';
                    });
                    
                    addAlert('超声波检测完成，未发现异常', 'success');
                    systemState.pantographHasIssue = false;
                }
                
                updateDetectionPoints();
            });
        }
        
        // 模拟维修过程
        function simulateRepair() {
            const repairStatus = elements.repairStatus;
            const pantographStatus = elements.pantographStatus;
            
            // 更新状态
            repairStatus.textContent = '维修中';
            repairStatus.className = 'status-value status-warning';
            
            // 模拟维修过程
            simulateProgress('维修', 7000, () => {
                repairStatus.textContent = '待机';
                repairStatus.className = 'status-value status-normal';
                pantographStatus.textContent = '正常';
                pantographStatus.className = 'status-value status-normal';
                
                // 禁用维修按钮
                elements.startRepair.disabled = true;
                
                // 修复检测点
                detectionPoints.forEach(point => {
                    if (point.status === 'issue') {
                        point.status = 'detected';
                    }
                });
                
                updateDetectionPoints();
                
                addAlert('维修完成，受电弓恢复正常', 'success');
                systemState.pantographHasIssue = false;
            });
        }
        
        // 模拟清洗过程
        function simulateCleaning() {
            const cleaningStatus = elements.cleaningStatus;
            
            // 更新状态
            cleaningStatus.textContent = '清洗中';
            cleaningStatus.className = 'status-value status-warning';
            
            // 模拟清洗过程
            simulateProgress('清洗', 4000, () => {
                cleaningStatus.textContent = '待机';
                cleaningStatus.className = 'status-value status-normal';
                
                addAlert('清洗完成，受电弓表面已清洁', 'success');
            });
        }
        
        // 模拟烘干过程
        function simulateDrying() {
            const dryingStatus = elements.dryingStatus;
            
            // 更新状态
            dryingStatus.textContent = '烘干中';
            dryingStatus.className = 'status-value status-warning';
            
            // 模拟烘干过程
            simulateProgress('烘干', 3000, () => {
                dryingStatus.textContent = '待机';
                dryingStatus.className = 'status-value status-normal';
                
                addAlert('烘干完成，受电弓已干燥', 'success');
            });
        }
        
        // 紧急停止
        function emergencyStop() {
            systemState.isOperating = false;
            systemState.currentOperation = null;
            
            // 重置进度条
            elements.operationProgress.style.width = '0%';
            elements.progressText.textContent = '已停止';
            
            // 重置所有状态
            elements.ultrasonicStatus.textContent = '已停止';
            elements.ultrasonicStatus.className = 'status-value status-warning';
            elements.repairStatus.textContent = '已停止';
            elements.repairStatus.className = 'status-value status-warning';
            elements.cleaningStatus.textContent = '已停止';
            elements.cleaningStatus.className = 'status-value status-warning';
            elements.dryingStatus.textContent = '已停止';
            elements.dryingStatus.className = 'status-value status-warning';
            
            // 重置检测点
            detectionPoints.forEach(point => {
                point.status = 'normal';
            });
            updateDetectionPoints();
            
            // 添加警报
            addAlert('紧急停止已激活，所有操作已中断', 'danger');
            
            // 禁用维修按钮
            elements.startRepair.disabled = true;
            
            // 更新任务状态
            if (systemState.currentOperation) {
                updateTaskStatus(systemState.currentOperation, 'pending');
            }
            
            // 记录操作历史
            addHistory('紧急停止');
        }
        
        // 生成检测报告
        function generateReport() {
            const now = new Date();
            const timestamp = `${now.toLocaleDateString()} ${now.toLocaleTimeString()}`;
            
            const report = `
列车受电弓检测与维护报告
============================

报告生成时间: ${timestamp}

系统状态:
--------
- 超声波检测系统: ${elements.ultrasonicStatus.textContent}
- 维修系统: ${elements.repairStatus.textContent}
- 清洗系统: ${elements.cleaningStatus.textContent}
- 烘干系统: ${elements.dryingStatus.textContent}
- 受电弓状态: ${elements.pantographStatus.textContent}

传感器数据:
----------
- 压力: ${document.getElementById('pressureSensor').textContent}
- 温度: ${document.getElementById('temperatureSensor').textContent}
- 振动: ${document.getElementById('vibrationSensor').textContent}
- 电流: ${document.getElementById('currentSensor').textContent}

检测结果:
--------
${systemState.pantographHasIssue ? 
'检测到受电弓存在异常，建议立即进行维修。' : 
'受电弓状态正常，未发现明显异常。'}

维护建议:
--------
${systemState.pantographHasIssue ? 
'1. 立即执行维修程序\n2. 维修完成后重新检测\n3. 记录维修详情' : 
'1. 按计划进行常规维护\n2. 继续监控传感器数据\n3. 定期生成检测报告'}

报告编号: RPT-${Date.now().toString().slice(-6)}
            `;
            
            elements.reportContent.textContent = report;
            addAlert('检测报告已生成', 'info');
        }
        
        // 导出报告
        function exportReport() {
            if (!elements.reportContent.textContent) {
                addAlert('请先生成检测报告', 'warning');
                return;
            }
            
            const blob = new Blob([elements.reportContent.textContent], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `受电弓检测报告_${new Date().toISOString().slice(0, 10)}.txt`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            addAlert('检测报告已导出', 'success');
        }
        
        // 显示确认模态框
        function showConfirmModal(title, message, confirmCallback) {
            elements.modalTitle.textContent = title;
            elements.modalMessage.textContent = message;
            elements.confirmModal.style.display = 'flex';
            
            // 设置确认按钮回调
            elements.modalConfirm.onclick = () => {
                elements.confirmModal.style.display = 'none';
                confirmCallback();
            };
        }
        
        // 事件监听
        elements.startDetection.addEventListener('click', () => {
            showConfirmModal('开始检测', '您确定要开始超声波检测吗？', simulateDetection);
        });
        
        elements.startRepair.addEventListener('click', () => {
            showConfirmModal('开始维修', '您确定要开始维修受电弓吗？', simulateRepair);
        });
        
        elements.startCleaning.addEventListener('click', () => {
            showConfirmModal('开始清洗', '您确定要开始清洗受电弓吗？', simulateCleaning);
        });
        
        elements.startDrying.addEventListener('click', () => {
            showConfirmModal('开始烘干', '您确定要开始烘干受电弓吗？', simulateDrying);
        });
        
        elements.emergencyStop.addEventListener('click', () => {
            elements.emergencyModal.style.display = 'flex';
        });
        
        elements.generateReport.addEventListener('click', generateReport);
        elements.exportReport.addEventListener('click', exportReport);
        
        elements.modalCancel.addEventListener('click', () => {
            elements.confirmModal.style.display = 'none';
        });
        
        elements.emergencyCancel.addEventListener('click', () => {
            elements.emergencyModal.style.display = 'none';
        });
        
        elements.emergencyConfirm.addEventListener('click', () => {
            elements.emergencyModal.style.display = 'none';
            emergencyStop();
        });
        
        // 标签页切换
        document.querySelectorAll('.tab').forEach(tab => {
            tab.addEventListener('click', () => {
                // 移除所有活动标签
                document.querySelectorAll('.tab').forEach(t => {
                    t.classList.remove('active');
                });
                
                // 隐藏所有标签内容
                document.querySelectorAll('.tab-pane').forEach(pane => {
                    pane.classList.remove('active');
                });
                
                // 激活当前标签
                tab.classList.add('active');
                
                // 显示对应内容
                const tabId = tab.getAttribute('data-tab');
                document.getElementById(`${tabId}-tab`).classList.add('active');
            });
        });
        
        // 初始化
        window.onload = function() {
            // 添加初始提示
            addAlert('系统初始化完成，准备执行任务', 'info');
            
            // 初始化数据图表
            updateDataChart(0);
            
            // 初始化传感器数据
            updateSensorData();
            
            // 设置传感器数据自动更新
            setInterval(updateSensorData, 3000);
        };
    </script>
</body>
</html>